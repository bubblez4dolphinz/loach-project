"0","# Get the loadings matrix (i.e., variable contributions to PCs)"
"0","loadings <- res.pca$rotation"
"0",""
"0","# Convert to a data frame for plotting"
"0","loadings_df <- as.data.frame(loadings)"
"0","loadings_df$Variable <- rownames(loadings_df)"
"0",""
"0","# (Optional) Reshape to long format for heatmap"
"0","loadings_long <- pivot_longer(loadings_df, "
"0","                               cols = starts_with(""PC""), "
"0","                               names_to = ""PC"", "
"0","                               values_to = ""Correlation"")"
"0",""
"0","# heatmap of loadings"
"0","loadingsPC_heatmap <- ggplot(loadings_long, aes(x = PC, y = Variable, fill = Correlation)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradient2(low = ""#6D9EC1"", high = ""#E46726"", mid = ""white"", "
"0","                       midpoint = 0, limit = c(-1, 1), space = ""Lab"") +"
"0","  theme_minimal() +"
"0","  labs(title = ""Variable Correlations (Loadings) with Principal Components"","
"0","       x = ""Principal Component"","
"0","       y = ""Original Variable"") +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
"0","ggsave(""Figures/ColourPatterns/PCA/Loadings-PC_Heatmap.png"", plot = loadingsPC_heatmap, width = 8, height = 5)"
