"0","# Get PC scores"
"0","scores <- res.pca$x"
"0",""
"0","# Compute correlation of original variables with PCs"
"0","cor_mat <- cor(normalised_data, scores)"
"0",""
"0","# Convert to long format for heatmap"
"0","cor_df <- as.data.frame(cor_mat)"
"0","cor_df$Variable <- rownames(cor_df)"
"0",""
"0","cor_long <- pivot_longer(cor_df, cols = starts_with(""PC""), "
"0","                         names_to = ""PC"", values_to = ""Correlation"")"
"0",""
"0","corPC_heatmap <- ggplot(cor_long, aes(x = PC, y = Variable, fill = Correlation)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradient2(low = ""#6D9EC1"", high = ""#E46726"", mid = ""white"") +"
"0","  theme_minimal() +"
"0","  labs(title = ""Variable Correlations with Principal Components"","
"0","       x = ""Principal Component"","
"0","       y = ""Original Variable"") +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
"0","ggsave(""Figures/ColourPatterns/PCA/Corrs-PC_Heatmap.png"", plot = corPC_heatmap, width = 8, height = 5)"
"0",""
