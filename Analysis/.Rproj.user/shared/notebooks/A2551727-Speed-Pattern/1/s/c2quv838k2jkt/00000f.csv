"0","# Create photo points at speed = 0"
"0","photo_points <- combined_data %>%"
"0","  select(TrialName, photo_CAA_Asp) %>%"
"0","  mutate("
"0","    speed = 0,"
"0","    CAA_Asp = photo_CAA_Asp,"
"0","    type = ""photo"""
"0","  )"
"0",""
"0","# Clip points (keep real speed)"
"0","clip_points <- combined_data %>%"
"0","  select(TrialName, speed, clip_CAA_Asp) %>%"
"0","  mutate("
"0","    CAA_Asp = clip_CAA_Asp,"
"0","    type = ""clip"""
"0","  )"
"0",""
"0","# Combine both for plotting"
"0","plot_data <- bind_rows(photo_points, clip_points)"
"0",""
"0","# Create a dataset of lines connecting each photo to its corresponding clip"
"0","web_lines <- left_join("
"0","  photo_points %>% select(TrialName, photo_speed = speed, photo_CAA_Asp = CAA_Asp),"
"0","  clip_points %>% select(TrialName, clip_speed = speed, clip_CAA_Asp = CAA_Asp),"
"0","  by = ""TrialName"""
"0",")"
"2","Warning: Detected an unexpected many-to-many relationship between `x` and `y`."
"0","# Plot"
"0","speed_CAA_Asp_plot <- ggplot(plot_data, aes(x = speed, y = CAA_Asp, color = type)) +"
"0","  # Draw grey lines connecting each photo to its clip"
"0","  geom_segment("
"0","    data = web_lines,"
"0","    aes("
"0","      x = photo_speed, y = photo_CAA_Asp,"
"0","      xend = clip_speed, yend = clip_CAA_Asp"
"0","    ),"
"0","    inherit.aes = FALSE,"
"0","    color = ""grey80"","
"0","    alpha = 0.2"
"0","  ) +"
"0","  # Fit regression line on clip data only"
"0","  geom_smooth("
"0","    data = clip_points,"
"0","    aes(x = speed, y = CAA_Asp),"
"0","    method = ""lm"","
"0","    se = TRUE,"
"0","    color = ""grey20"""
"0","  ) +"
"0","  # Plot points"
"0","  geom_point(size = 2) +"
"0","  scale_color_manual(values = c(photo = ""sienna4"", clip = ""#E69F00"")) +"
"0","  theme_minimal() +"
"0","  labs("
"0","    x = ""Speed"","
"0","    y = ""CAA:Asp"","
"0","    color = ""Data Type"","
"0","    title = ""How Aspect Ratio Changes with Speed"""
"0","  ) +"
"0","  theme("
"0","    legend.position = ""bottom""                   # legend at bottom"
"0","  )"
"0",""
"0","speed_CAA_Asp_plot"
