"0",""
"0","# Function to convert group names to clean titles"
"0","format_group_title <- function(group_string) {"
"0","  parts <- unlist(strsplit(group_string, ""-""))"
"0","  species <- gsub(""_"", "" "", parts[1])"
"0","  treatment <- ifelse(parts[2] == ""C"", ""Control"", ""Predator"")"
"0","  paste0(species, "" - "", treatment)"
"0","}"
"0",""
"0","# Create color palette for speed"
"0","n_colors <- 100"
"0","palette_fn <- colorRampPalette(viridis::viridis(n_colors))"
"0","colors <- palette_fn(n_colors)"
"0",""
"0","# Get speed values and color assignments"
"0","speed_vals <- meta_stats$trans_median_speed"
"0","speed_range <- range(speed_vals, na.rm = TRUE)"
"0","speed_indices <- as.integer(cut(speed_vals, breaks = n_colors, include.lowest = TRUE))"
"0","speed_colors <- colors[speed_indices]"
"0",""
"0","# Define unique groups"
"0","groups <- unique(meta_data$Group)"
"0",""
"0","# Axis limits for consistency"
"0","all_x <- unlist(lapply(trjs, function(t) t$smooth$x))"
"0","all_y <- unlist(lapply(trjs, function(t) t$smooth$y))"
"0","xlim_all <- range(all_x)"
"0","ylim_all <- range(all_y)"
"0",""
"0","# Plot function (used for both SVG and PNG)"
"0","plot_trajectories <- function(filename, type = c(""svg"", ""png"")) {"
"0","  if (type == ""svg"") {"
"0","    svg(filename, width = 10, height = 6)"
"0","  } else {"
"0","    png(filename, width = 1000, height = 600, res = 150)"
"0","  }"
"0",""
"0","  par(mfrow = c(2, 2), mar = c(4, 4, 3, 1))"
"0",""
"0","  for (grp in groups) {"
"0","    idx <- which(meta_data$Group == grp)"
"0","    title <- format_group_title(grp)"
"0",""
"0","    plot(NA, xlim = xlim_all, ylim = rev(ylim_all),"
"0","         xlab = ""x (m)"", ylab = ""y (m)"", main = title)"
"0",""
"0","    for (i in idx) {"
"0","      trj_smooth <- trjs[[i]]$smooth"
"0","      lines(trj_smooth, col = speed_colors[i], lwd = 1.5)"
"0","    }"
"0","  }"
"0",""
"0","  # Add legend"
"0","image.plot(legend.only = TRUE, zlim = speed_range, col = colors,"
"0","           legend.args = list(text = ""Median Speed (m/s)"", side = 4, line = 2.5))"
"0",""
"0",""
"0","  dev.off()"
"0","}"
"0",""
"0","# Save both formats"
"0","plot_trajectories(""Figures/Kinematics/PlotTrajectories.svg"", type = ""svg"")"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","plot_trajectories(""Figures/Kinematics/PlotTrajectories.png"", type = ""png"")"
"1","null device "
"1","
"
"1","          1 "
"1","
"
