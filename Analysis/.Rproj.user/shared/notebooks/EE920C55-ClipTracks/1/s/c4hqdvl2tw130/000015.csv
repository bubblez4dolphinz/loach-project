"0","library(gt)"
"0","library(magick)"
"0","library(dplyr)"
"0","library(broom) # for tidy()"
"0",""
"0","combined_model_summary_gt <- function(model, model_name, out_dir = NULL, file_name = NULL) {"
"0","  # 1. Fixed effects from tidy()"
"0","  fixed_df <- tidy(model, conf.int = FALSE) %>%"
"0","    filter(effect == ""fixed"") %>%"
"0","    select(term, estimate, std.error, statistic, p.value) %>%"
"0","    mutate("
"0","      p_stars_coef = case_when("
"0","        p.value < 0.001 ~ ""***"","
"0","        p.value < 0.01  ~ ""**"","
"0","        p.value < 0.05  ~ ""*"","
"0","        TRUE            ~ """""
"0","      )"
"0","    )"
"0","  "
"0","  gt_fixed <- fixed_df %>%"
"0","    gt(rowname_col = ""term"") %>%"
"0","    tab_header(title = paste(model_name, ""- Fixed Effects Summary"")) %>%"
"0","    fmt_number("
"0","      columns = c(""estimate"", ""std.error"", ""statistic"", ""p.value""),"
"0","      decimals = 3"
"0","    ) %>%"
"0","    cols_label("
"0","      estimate     = ""Estimate"","
"0","      std.error    = ""SE"","
"0","      statistic    = ""z"","
"0","      p.value      = ""p (coef)"","
"0","      p_stars_coef = """""
"0","    )"
"0","  "
"0","  # 2. Term-deletion results from drop1()"
"0","  drop_df <- drop1(model, test = ""Chi"") %>%"
"0","    as.data.frame() %>%"
"0","    tibble::rownames_to_column(""term"") %>%"
"0","    filter(term != ""<none>"") %>%"
"0","    mutate("
"0","      p_stars_drop = case_when("
"0","        `Pr(>Chi)` < 0.001 ~ ""***"","
"0","        `Pr(>Chi)` < 0.01  ~ ""**"","
"0","        `Pr(>Chi)` < 0.05  ~ ""*"","
"0","        TRUE               ~ """""
"0","      )"
"0","    )"
"0","  "
"0","  gt_drop1 <- drop_df %>%"
"0","    gt(rowname_col = ""term"") %>%"
"0","    tab_header(title = paste(model_name, ""- Drop1 Summary"")) %>%"
"0","    fmt_number("
"0","      columns = c(""AIC"", ""LRT"", ""Pr(>Chi)""),"
"0","      decimals = 3"
"0","    ) %>%"
"0","    cols_label("
"0","      Df           = ""df"","
"0","      AIC          = ""AIC"","
"0","      LRT          = ""Chi-sq"","
"0","      `Pr(>Chi)`   = ""p (drop1)"","
"0","      p_stars_drop = """""
"0","    )"
"0","  "
"0","  if (!is.null(out_dir) && !is.null(file_name)) {"
"0","    dir.create(out_dir, recursive = TRUE, showWarnings = FALSE)"
"0","    "
"0","    # Temporary files for individual tables"
"0","    fixed_file <- tempfile(fileext = "".png"")"
"0","    drop1_file <- tempfile(fileext = "".png"")"
"0","    "
"0","    gtsave(gt_fixed, fixed_file)"
"0","    gtsave(gt_drop1, drop1_file)"
"0","    "
"0","    # Read images with magick"
"0","    img_fixed <- image_read(fixed_file)"
"0","    img_drop1 <- image_read(drop1_file)"
"0","    "
"0","    # Resize images to the same height for neatness (optional)"
"0","    height <- max(image_info(img_fixed)$height, image_info(img_drop1)$height)"
"0","    img_fixed <- image_scale(img_fixed, paste0(""x"", height))"
"0","    img_drop1 <- image_scale(img_drop1, paste0(""x"", height))"
"0","    "
"0","    # Combine side-by-side"
"0","    combined <- image_append(c(img_fixed, img_drop1))"
"0","    "
"0","    # Save combined image"
"0","    image_write(combined, path = file.path(out_dir, file_name), format = ""png"")"
"0","    "
"0","    # Clean up temporary files"
"0","    file.remove(fixed_file, drop1_file)"
"0","  }"
"0","}"
"0",""
"0","iwalk(models, ~ combined_model_summary_gt("
"0","  model      = .x,"
"0","  model_name = .y,"
"0","  out_dir    = ""Figures/Models/Kinematics/Results2"","
"0","  file_name  = paste0(.y, ""_summary_combined.png"")"
"0","))"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c419a819ac.html screenshot completed
"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c4603974e9.html screenshot completed
"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c452b361.html screenshot completed
"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c456962100.html screenshot completed
"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c443525a9a.html screenshot completed
"
"2","file:///C:/Users/flora/AppData/Local/Temp/Rtmp25c7tb/file18c44e60538e.html screenshot completed
"
